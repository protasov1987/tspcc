# Автоскроллинг вкладки «Трекер»

Автопрокрутка срабатывает, когда пользователь разворачивает карточку или групповую карточку, чтобы увидеть её операции:

- Компонент `renderWorkordersTable` навешивает обработчики `toggle` на элементы `<details>` с классами `.wo-card` и `.group-wo-card`. При открытии он запоминает идентификатор элемента в наборах `workorderOpenCards` или `workorderOpenGroups` и вызывает `scrollWorkorderDetailsIntoViewIfNeeded(detail)` для прокрутки к открытому блоку.
- `scrollWorkorderDetailsIntoViewIfNeeded` проверяет, что автопрокрутка включена (`workorderAutoScrollEnabled`), не была временно подавлена (`suppressWorkorderAutoscroll`) и что у карточки есть DOM-элемент. Затем в `requestAnimationFrame` сверяет положение карточки с высотой окна. Если её верх оказался под шапкой или нижняя граница вышла за экран, вычисляет целевую позицию с учётом высоты шапки (`headerOffset`) и 16 px отступа и плавно прокручивает `window` к этому месту через `window.scrollTo({ behavior: 'smooth' })`.
- Флаг `workorderAutoScrollEnabled` синхронизируется с чекбоксом `#workorder-autoscroll`, а временное подавление (`suppressWorkorderAutoscroll`) устанавливается вокруг действий, которые не должны перемещать экран (например, добавление/удаление доп. исполнителя или смена статуса операции). Во время подавления применяется `withWorkorderScrollLock`, который запоминает текущий `scrollX/scrollY` и восстанавливает их после перерисовки, исключая нежелательные прыжки.

Таким образом, автопрокрутка включается только после явного раскрытия карточки и срабатывает один раз, если она не полностью видна, при этом уважая отключение в настройках и временные запреты на прокрутку.
